# 5.3. Kết quả mô phỏng

## Bảng 1: Kết quả RMSE (echantillon) của 6 phương pháp tại các mức SNR khác nhau

Bảng 1 trình bày kết quả RMSE (echantillon) của 6 phương pháp tại các mức SNR khác nhau:

| SNR (dB) | CC_time | ROTH | SCOT | PHAT | ECKART | HT |
|----------|---------|------|------|------|--------|-----|
| 0        | 0.5462  | 3.4675 | 3.4675 | 3.9725 | 0.4294 | 0.4540 |
| 10       | 0.0787  | 1.2625 | 1.2625 | 0.4837 | 0.1394 | 0.1358 |
| 20       | 0.0379  | 0.5717 | 0.5717 | 0.0876 | 0.0612 | 0.0609 |

**Ghi chú**: Kết quả được tính từ 100 lần mô phỏng Monte Carlo với các tham số: N = 256 samples, Fs = 2048 Hz, τ_true = 4.9 samples, phổ Farina-Merletti (f_h=120Hz, f_l=60Hz).

## Nhận xét kết quả

### 1. So sánh hiệu năng các phương pháp

• **ECKART** đạt RMSE thấp nhất ở SNR = 0 dB (0.4294) và SNR = 20 dB (0.0612), cho thấy hiệu quả tốt trong việc sử dụng phổ tín hiệu sạch và phổ nhiễu để thiết kế bộ lọc tối ưu.

• **HT (Hannan-Thomson)** đạt RMSE thấp nhất ở SNR = 10 dB (0.1358) và gần bằng ECKART ở SNR = 20 dB (0.0609), xác nhận tính tối ưu lý thuyết của phương pháp Maximum Likelihood.

• **CC_time** (Cross-Correlation trong miền thời gian) cho kết quả tốt ở SNR cao (20 dB: 0.0379) và trung bình (10 dB: 0.0787), nhưng kém hơn ở SNR thấp (0 dB: 0.5462). Phương pháp này đơn giản nhưng hiệu quả khi SNR ≥ 10 dB.

• **PHAT** (Phase Transform) có hiệu năng kém ở SNR thấp (0 dB: 3.9725) do dễ bị ảnh hưởng bởi nhiễu pha, nhưng cải thiện đáng kể ở SNR cao (20 dB: 0.0876).

• **SCOT** và **ROTH** có hiệu năng tương đương nhau (RMSE giống hệt nhau), cho thấy cả hai phương pháp chuẩn hóa đều hoạt động tương tự trong điều kiện mô phỏng này. Tuy nhiên, cả hai đều có RMSE cao hơn các phương pháp khác, đặc biệt ở SNR thấp (0 dB: 3.4675).

### 2. Ảnh hưởng của SNR

• Tất cả phương pháp đều cải thiện đáng kể khi SNR tăng từ 0 dB lên 20 dB. RMSE giảm rõ rệt, đặc biệt ở khoảng 0-10 dB.

• Với SNR = 20 dB, sai số RMSE < 0.1 samples cho hầu hết các phương pháp (trừ ROTH và SCOT), tương ứng độ chính xác CV cao.

• Ở SNR thấp (0 dB), sự khác biệt giữa các phương pháp rõ rệt nhất. ECKART và HT vượt trội hơn so với các phương pháp còn lại, trong khi PHAT, ROTH và SCOT có sai số rất lớn.

• Ở SNR trung bình (10 dB), CC_time, ECKART và HT cho kết quả tốt nhất, với RMSE < 0.15 samples.

• Ở SNR cao (20 dB), tất cả phương pháp (trừ ROTH và SCOT) đều cho kết quả tốt, với RMSE < 0.1 samples. ECKART và HT đạt độ chính xác cao nhất.

### 3. Độ chính xác ước lượng

• Với SNR = 20 dB và τ_true = 4.9 samples:
  - ECKART: RMSE = 0.0612 samples → Độ chính xác cao nhất
  - HT: RMSE = 0.0609 samples → Gần bằng ECKART
  - CC_time: RMSE = 0.0379 samples → Tốt, đơn giản
  - PHAT: RMSE = 0.0876 samples → Chấp nhận được

• Với SNR = 10 dB, CC_time (0.0787), ECKART (0.1394) và HT (0.1358) cho độ chính xác chấp nhận được.

• Với SNR = 0 dB, chỉ ECKART (0.4294) và HT (0.4540) cho kết quả đáng tin cậy. Các phương pháp khác có sai số rất lớn.

### 4. Khuyến nghị sử dụng

• **SNR cao (20 dB)**: Tất cả phương pháp (trừ ROTH và SCOT) đều cho kết quả tốt. Có thể sử dụng CC_time cho đơn giản hoặc ECKART/HT cho độ chính xác tối đa.

• **SNR trung bình (10 dB)**: Nên sử dụng CC_time, ECKART hoặc HT. Tránh PHAT, ROTH và SCOT.

• **SNR thấp (0 dB)**: Chỉ nên sử dụng ECKART hoặc HT. Các phương pháp khác không đáng tin cậy ở mức SNR này.

### 5. Hạn chế và quan sát

• Kết quả mô phỏng dựa trên tín hiệu sEMG giả lập với phổ Farina-Merletti. Trong thực tế, phổ tín hiệu có thể khác, ảnh hưởng đến hiệu năng.

• Số điểm tín hiệu N = 256 samples (125ms) có thể ngắn, ảnh hưởng đến độ chính xác của các phương pháp dựa trên phổ (ROTH, SCOT, PHAT).

• Window size h_Length = 128 có thể nhỏ so với NFFT = 256, ảnh hưởng đến chất lượng ước lượng phổ trong phương pháp Welch.

• Số lần lặp Monte Carlo = 100 có thể chưa đủ để ước lượng chính xác, đặc biệt với các phương pháp có phương sai cao như ROTH và SCOT.

• ROTH và SCOT cho kết quả giống hệt nhau và có RMSE cao, có thể do vấn đề trong cách tính toán hoặc do điều kiện mô phỏng không phù hợp với các phương pháp này.

• PHAT có sai số rất lớn ở SNR thấp (0 dB: 3.9725), cho thấy phương pháp này rất nhạy cảm với nhiễu pha khi SNR thấp.

## Bảng 2: Kết quả Độ lệch chuẩn (echantillon)

| SNR (dB) | CC_time | ROTH | SCOT | PHAT | ECKART | HT |
|----------|---------|------|------|------|--------|-----|
| 0        | 0.7102  | 3.4328 | 3.4328 | 3.8728 | 0.4290 | 0.4535 |
| 10       | 0.2196  | 1.2361 | 1.2361 | 0.4728 | 0.1314 | 0.1219 |
| 20       | 0.1389  | 0.5707 | 0.5707 | 0.0729 | 0.0472 | 0.0422 |

## Bảng 3: Kết quả Bias (echantillon)

| SNR (dB) | CC_time | ROTH | SCOT | PHAT | ECKART | HT |
|----------|---------|------|------|------|--------|-----|
| 0        | -0.2045 | 0.4896 | 0.4896 | 0.8843 | 0.0188 | 0.0211 |
| 10       | -0.1746 | -0.2566 | -0.2566 | -0.1024 | -0.0467 | -0.0597 |
| 20       | -0.1363 | -0.0342 | -0.0342 | -0.0487 | -0.0390 | -0.0440 |

## Bảng 4: Kết quả Phương sai (echantillon²)

| SNR (dB) | CC_time | ROTH | SCOT | PHAT | ECKART | HT |
|----------|---------|------|------|------|--------|-----|
| 0        | 0.5043  | 11.7840 | 11.7840 | 14.9985 | 0.1841 | 0.2057 |
| 10       | 0.0482  | 1.5280 | 1.5280 | 0.2235 | 0.0173 | 0.0149 |
| 20       | 0.0193  | 0.3256 | 0.3256 | 0.0053 | 0.0022 | 0.0018 |

## Bảng 5: Kết quả Độ trễ ước lượng (echantillon)

| SNR (dB) | CC_time | ROTH | SCOT | PHAT | ECKART | HT |
|----------|---------|------|------|------|--------|-----|
| 0        | 4.6955  | 5.3896 | 5.3896 | 5.7843 | 4.9188 | 4.9211 |
| 10       | 4.7254  | 4.6434 | 4.6434 | 4.7976 | 4.8533 | 4.8403 |
| 20       | 4.7637  | 4.8658 | 4.8658 | 4.8513 | 4.8610 | 4.8560 |

**Lưu ý**: Giá trị độ trễ thực τ_true = 4.9 samples. Tất cả các phương pháp đều ước lượng gần đúng giá trị này, với độ chính xác tăng dần khi SNR tăng.

